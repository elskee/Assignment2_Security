[
    {
        "label": "os",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "os",
        "description": "os",
        "detail": "os",
        "documentation": {}
    },
    {
        "label": "pandas",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "pandas",
        "description": "pandas",
        "detail": "pandas",
        "documentation": {}
    },
    {
        "label": "psycopg2",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "psycopg2",
        "description": "psycopg2",
        "detail": "psycopg2",
        "documentation": {}
    },
    {
        "label": "OperationalError",
        "importPath": "psycopg2",
        "description": "psycopg2",
        "isExtraImport": true,
        "detail": "psycopg2",
        "documentation": {}
    },
    {
        "label": "load_dotenv",
        "importPath": "dotenv",
        "description": "dotenv",
        "isExtraImport": true,
        "detail": "dotenv",
        "documentation": {}
    },
    {
        "label": "create_engine",
        "importPath": "sqlalchemy",
        "description": "sqlalchemy",
        "isExtraImport": true,
        "detail": "sqlalchemy",
        "documentation": {}
    },
    {
        "label": "main",
        "kind": 2,
        "importPath": "export_to_excel",
        "description": "export_to_excel",
        "peekOfCode": "def main():\n    # Load environment variables from .env file\n    load_dotenv()\n    # Get database connection parameters from environment\n    db_config = {\n        'host': os.getenv('POSTGRES_HOST', '127.0.0.1'),\n        'port': os.getenv('POSTGRES_PORT', '5432'),\n        'database': os.getenv('POSTGRES_DBNAME', 'postgrescvedumper'),\n        'user': os.getenv('POSTGRES_USER', 'postgrescvedumper'),\n        'password': os.getenv('POSTGRES_PASSWORD')",
        "detail": "export_to_excel",
        "documentation": {}
    },
    {
        "label": "create_connection",
        "kind": 2,
        "importPath": "test",
        "description": "test",
        "peekOfCode": "def create_connection(db_name, db_user, db_password, db_host, db_port):\n    \"\"\"\n    create a connection to a PostgreSQL database using SQLAlchemy\n    \"\"\"\n    try:\n        engine = create_engine(f'postgresql://{db_user}:{db_password}@{db_host}:{db_port}/{db_name}')\n    except Exception as e:\n        print(f\"An error occurred: {e}\")\n        return None\n    return engine",
        "detail": "test",
        "documentation": {}
    },
    {
        "label": "db_name",
        "kind": 5,
        "importPath": "test",
        "description": "test",
        "peekOfCode": "db_name = \"postgrescvedumper\"\ndb_user = \"postgrescvedumper\"\ndb_password = \"a42a18537d74c3b7e584c769152c3d\"\ndb_host = \"127.0.0.1\"\ndb_port = \"5432\"\nconn = create_connection(db_name, db_user, db_password, db_host, db_port)\nquery = \"\"\"\nSELECT cv.cve_id, f.filename, f.num_lines_added, f.num_lines_deleted, f.code_before, f.code_after, cc.cwe_id \nFROM file_change f, commits c, fixes fx, cve cv, cwe_classification cc\nWHERE f.hash = c.hash ",
        "detail": "test",
        "documentation": {}
    },
    {
        "label": "db_user",
        "kind": 5,
        "importPath": "test",
        "description": "test",
        "peekOfCode": "db_user = \"postgrescvedumper\"\ndb_password = \"a42a18537d74c3b7e584c769152c3d\"\ndb_host = \"127.0.0.1\"\ndb_port = \"5432\"\nconn = create_connection(db_name, db_user, db_password, db_host, db_port)\nquery = \"\"\"\nSELECT cv.cve_id, f.filename, f.num_lines_added, f.num_lines_deleted, f.code_before, f.code_after, cc.cwe_id \nFROM file_change f, commits c, fixes fx, cve cv, cwe_classification cc\nWHERE f.hash = c.hash \nAND c.hash = fx.hash ",
        "detail": "test",
        "documentation": {}
    },
    {
        "label": "db_password",
        "kind": 5,
        "importPath": "test",
        "description": "test",
        "peekOfCode": "db_password = \"a42a18537d74c3b7e584c769152c3d\"\ndb_host = \"127.0.0.1\"\ndb_port = \"5432\"\nconn = create_connection(db_name, db_user, db_password, db_host, db_port)\nquery = \"\"\"\nSELECT cv.cve_id, f.filename, f.num_lines_added, f.num_lines_deleted, f.code_before, f.code_after, cc.cwe_id \nFROM file_change f, commits c, fixes fx, cve cv, cwe_classification cc\nWHERE f.hash = c.hash \nAND c.hash = fx.hash \nAND fx.cve_id = cv.cve_id ",
        "detail": "test",
        "documentation": {}
    },
    {
        "label": "db_host",
        "kind": 5,
        "importPath": "test",
        "description": "test",
        "peekOfCode": "db_host = \"127.0.0.1\"\ndb_port = \"5432\"\nconn = create_connection(db_name, db_user, db_password, db_host, db_port)\nquery = \"\"\"\nSELECT cv.cve_id, f.filename, f.num_lines_added, f.num_lines_deleted, f.code_before, f.code_after, cc.cwe_id \nFROM file_change f, commits c, fixes fx, cve cv, cwe_classification cc\nWHERE f.hash = c.hash \nAND c.hash = fx.hash \nAND fx.cve_id = cv.cve_id \nAND cv.cve_id = cc.cve_id ",
        "detail": "test",
        "documentation": {}
    },
    {
        "label": "db_port",
        "kind": 5,
        "importPath": "test",
        "description": "test",
        "peekOfCode": "db_port = \"5432\"\nconn = create_connection(db_name, db_user, db_password, db_host, db_port)\nquery = \"\"\"\nSELECT cv.cve_id, f.filename, f.num_lines_added, f.num_lines_deleted, f.code_before, f.code_after, cc.cwe_id \nFROM file_change f, commits c, fixes fx, cve cv, cwe_classification cc\nWHERE f.hash = c.hash \nAND c.hash = fx.hash \nAND fx.cve_id = cv.cve_id \nAND cv.cve_id = cc.cve_id \nAND f.programming_language = 'Python'",
        "detail": "test",
        "documentation": {}
    },
    {
        "label": "conn",
        "kind": 5,
        "importPath": "test",
        "description": "test",
        "peekOfCode": "conn = create_connection(db_name, db_user, db_password, db_host, db_port)\nquery = \"\"\"\nSELECT cv.cve_id, f.filename, f.num_lines_added, f.num_lines_deleted, f.code_before, f.code_after, cc.cwe_id \nFROM file_change f, commits c, fixes fx, cve cv, cwe_classification cc\nWHERE f.hash = c.hash \nAND c.hash = fx.hash \nAND fx.cve_id = cv.cve_id \nAND cv.cve_id = cc.cve_id \nAND f.programming_language = 'Python'\nAND cc.cwe_id = 'CWE-89'",
        "detail": "test",
        "documentation": {}
    },
    {
        "label": "query",
        "kind": 5,
        "importPath": "test",
        "description": "test",
        "peekOfCode": "query = \"\"\"\nSELECT cv.cve_id, f.filename, f.num_lines_added, f.num_lines_deleted, f.code_before, f.code_after, cc.cwe_id \nFROM file_change f, commits c, fixes fx, cve cv, cwe_classification cc\nWHERE f.hash = c.hash \nAND c.hash = fx.hash \nAND fx.cve_id = cv.cve_id \nAND cv.cve_id = cc.cve_id \nAND f.programming_language = 'Python'\nAND cc.cwe_id = 'CWE-89'\n\"\"\"",
        "detail": "test",
        "documentation": {}
    },
    {
        "label": "python_sql_injection_fixes",
        "kind": 5,
        "importPath": "test",
        "description": "test",
        "peekOfCode": "python_sql_injection_fixes = pd.read_sql_query(query, conn)\npython_sql_injection_fixes.head(5)",
        "detail": "test",
        "documentation": {}
    }
]